<template>
  <Dialog :open="open" @update:open="$emit('update:open', $event)">
    <DialogContent class="max-w-md">
      <DialogHeader>
        <DialogTitle>Insert Emoji</DialogTitle>
        <DialogDescription>
          Choose an emoji to insert into your document
        </DialogDescription>
      </DialogHeader>
      
      <div class="mt-4">
        <TooltipProvider>
          <Tabs v-model="activeTab" class="w-full">
          <TabsList class="grid w-full grid-cols-6">
            <TabsTrigger value="recent">
              <Tooltip>
                <TooltipTrigger as-child>
                  <span>üïí</span>
                </TooltipTrigger>
                <TooltipContent>
                  <p>Recently used</p>
                </TooltipContent>
              </Tooltip>
            </TabsTrigger>
            <TabsTrigger value="smileys">
              <Tooltip>
                <TooltipTrigger as-child>
                  <span>üòÄ</span>
                </TooltipTrigger>
                <TooltipContent>
                  <p>Smileys & People</p>
                </TooltipContent>
              </Tooltip>
            </TabsTrigger>
            <TabsTrigger value="animals">
              <Tooltip>
                <TooltipTrigger as-child>
                  <span>üê∂</span>
                </TooltipTrigger>
                <TooltipContent>
                  <p>Animals & Nature</p>
                </TooltipContent>
              </Tooltip>
            </TabsTrigger>
            <TabsTrigger value="food">
              <Tooltip>
                <TooltipTrigger as-child>
                  <span>üçé</span>
                </TooltipTrigger>
                <TooltipContent>
                  <p>Food & Drink</p>
                </TooltipContent>
              </Tooltip>
            </TabsTrigger>
            <TabsTrigger value="activities">
              <Tooltip>
                <TooltipTrigger as-child>
                  <span>‚öΩ</span>
                </TooltipTrigger>
                <TooltipContent>
                  <p>Activities</p>
                </TooltipContent>
              </Tooltip>
            </TabsTrigger>
            <TabsTrigger value="objects">
              <Tooltip>
                <TooltipTrigger as-child>
                  <span>üí°</span>
                </TooltipTrigger>
                <TooltipContent>
                  <p>Objects</p>
                </TooltipContent>
              </Tooltip>
            </TabsTrigger>
          </TabsList>
          
          <TabsContent value="recent" class="mt-4">
            <div class="grid grid-cols-8 gap-1 max-h-48 overflow-y-auto">
              <button
                v-for="emoji in recentEmojis"
                :key="emoji.char"
                @click="selectEmoji(emoji)"
                class="p-2 hover:bg-gray-100 rounded text-2xl transition-colors"
                :title="emoji.name"
              >
                <Tooltip>
                  <TooltipTrigger as-child>
                    <span>{{ emoji.char }}</span>
                  </TooltipTrigger>
                  <TooltipContent>
                    <p>{{ emoji.name }}</p>
                  </TooltipContent>
                </Tooltip>
              </button>
            </div>
            <div v-if="recentEmojis.length === 0" class="text-center text-gray-500 py-8">
              No recently used emojis
            </div>
          </TabsContent>
          
          <TabsContent value="smileys" class="mt-4">
            <div class="grid grid-cols-8 gap-1 max-h-48 overflow-y-auto">
              <button
                v-for="emoji in smileyEmojis"
                :key="emoji.char"
                @click="selectEmoji(emoji)"
                class="p-2 hover:bg-gray-100 rounded text-2xl transition-colors"
                :title="emoji.name"
              >
                <Tooltip>
                  <TooltipTrigger as-child>
                    <span>{{ emoji.char }}</span>
                  </TooltipTrigger>
                  <TooltipContent>
                    <p>{{ emoji.name }}</p>
                  </TooltipContent>
                </Tooltip>
              </button>
            </div>
          </TabsContent>
          
          <TabsContent value="animals" class="mt-4">
            <div class="grid grid-cols-8 gap-1 max-h-48 overflow-y-auto">
              <button
                v-for="emoji in animalEmojis"
                :key="emoji.char"
                @click="selectEmoji(emoji)"
                class="p-2 hover:bg-gray-100 rounded text-2xl transition-colors"
                :title="emoji.name"
              >
                <Tooltip>
                  <TooltipTrigger as-child>
                    <span>{{ emoji.char }}</span>
                  </TooltipTrigger>
                  <TooltipContent>
                    <p>{{ emoji.name }}</p>
                  </TooltipContent>
                </Tooltip>
              </button>
            </div>
          </TabsContent>
          
          <TabsContent value="food" class="mt-4">
            <div class="grid grid-cols-8 gap-1 max-h-48 overflow-y-auto">
              <button
                v-for="emoji in foodEmojis"
                :key="emoji.char"
                @click="selectEmoji(emoji)"
                class="p-2 hover:bg-gray-100 rounded text-2xl transition-colors"
                :title="emoji.name"
              >
                <Tooltip>
                  <TooltipTrigger as-child>
                    <span>{{ emoji.char }}</span>
                  </TooltipTrigger>
                  <TooltipContent>
                    <p>{{ emoji.name }}</p>
                  </TooltipContent>
                </Tooltip>
              </button>
            </div>
          </TabsContent>
          
          <TabsContent value="activities" class="mt-4">
            <div class="grid grid-cols-8 gap-1 max-h-48 overflow-y-auto">
              <button
                v-for="emoji in activityEmojis"
                :key="emoji.char"
                @click="selectEmoji(emoji)"
                class="p-2 hover:bg-gray-100 rounded text-2xl transition-colors"
                :title="emoji.name"
              >
                <Tooltip>
                  <TooltipTrigger as-child>
                    <span>{{ emoji.char }}</span>
                  </TooltipTrigger>
                  <TooltipContent>
                    <p>{{ emoji.name }}</p>
                  </TooltipContent>
                </Tooltip>
              </button>
            </div>
          </TabsContent>
          
          <TabsContent value="objects" class="mt-4">
            <div class="grid grid-cols-8 gap-1 max-h-48 overflow-y-auto">
              <button
                v-for="emoji in objectEmojis"
                :key="emoji.char"
                @click="selectEmoji(emoji)"
                class="p-2 hover:bg-gray-100 rounded text-2xl transition-colors"
                :title="emoji.name"
              >
                <Tooltip>
                  <TooltipTrigger as-child>
                    <span>{{ emoji.char }}</span>
                  </TooltipTrigger>
                  <TooltipContent>
                    <p>{{ emoji.name }}</p>
                  </TooltipContent>
                </Tooltip>
              </button>
            </div>
          </TabsContent>
        </Tabs>
        </TooltipProvider>
      </div>
      
      <DialogFooter>
        <Button variant="outline" @click="$emit('update:open', false)">
          Cancel
        </Button>
      </DialogFooter>
    </DialogContent>
  </Dialog>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue'
import { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '@/components/ui/dialog'
import { Button } from '@/components/ui/button'
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'
import { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip'

interface Emoji {
  char: string
  name: string
  shortcode: string
}

const props = defineProps<{
  open: boolean
}>()

const emit = defineEmits<{
  (e: 'update:open', value: boolean): void
  (e: 'insert-emoji', emoji: Emoji): void
}>()

const activeTab = ref('recent')
const recentEmojis = ref<Emoji[]>([])

// Check if emoji is supported on the current OS
function isEmojiSupported(emoji: string): boolean {
  if (typeof window === 'undefined') return false
  
  const canvas = document.createElement('canvas')
  canvas.width = 10
  canvas.height = 10
  const ctx = canvas.getContext('2d')
  if (!ctx) return false
  
  ctx.textBaseline = 'top'
  ctx.font = '8px Arial'
  ctx.fillText(emoji, 0, 0)
  
  return ctx.getImageData(0, 0, 10, 10).data.some(pixel => pixel !== 0)
}

// Filter emojis based on OS support
function filterSupportedEmojis(emojis: Emoji[]): Emoji[] {
  return emojis.filter(emoji => isEmojiSupported(emoji.char))
}

// Emoji data - these are commonly supported across all platforms
const smileyEmojis = ref<Emoji[]>([
  { char: 'üòÄ', name: 'Grinning Face', shortcode: ':grinning:' },
  { char: 'üòÉ', name: 'Grinning Face with Big Eyes', shortcode: ':smiley:' },
  { char: 'üòÑ', name: 'Grinning Face with Smiling Eyes', shortcode: ':smile:' },
  { char: 'üòÅ', name: 'Beaming Face with Smiling Eyes', shortcode: ':grin:' },
  { char: 'üòÜ', name: 'Grinning Squinting Face', shortcode: ':laughing:' },
  { char: 'üòÖ', name: 'Grinning Face with Sweat', shortcode: ':sweat_smile:' },
  { char: 'ü§£', name: 'Rolling on the Floor Laughing', shortcode: ':rofl:' },
  { char: 'üòÇ', name: 'Face with Tears of Joy', shortcode: ':joy:' },
  { char: 'üôÇ', name: 'Slightly Smiling Face', shortcode: ':slightly_smiling_face:' },
  { char: 'üôÉ', name: 'Upside-Down Face', shortcode: ':upside_down_face:' },
  { char: 'üòâ', name: 'Winking Face', shortcode: ':wink:' },
  { char: 'üòä', name: 'Smiling Face with Smiling Eyes', shortcode: ':blush:' },
  { char: 'üòá', name: 'Smiling Face with Halo', shortcode: ':innocent:' },
  { char: 'ü•∞', name: 'Smiling Face with Hearts', shortcode: ':smiling_face_with_hearts:' },
  { char: 'üòç', name: 'Smiling Face with Heart-Eyes', shortcode: ':heart_eyes:' },
  { char: 'ü§©', name: 'Star-Struck', shortcode: ':star_struck:' },
  { char: 'üòò', name: 'Face Blowing a Kiss', shortcode: ':kissing_heart:' },
  { char: 'üòó', name: 'Kissing Face', shortcode: ':kissing:' },
  { char: 'üòö', name: 'Kissing Face with Closed Eyes', shortcode: ':kissing_closed_eyes:' },
  { char: 'üòô', name: 'Kissing Face with Smiling Eyes', shortcode: ':kissing_smiling_eyes:' },
  { char: 'ü•≤', name: 'Smiling Face with Tear', shortcode: ':smiling_face_with_tear:' },
  { char: 'üòã', name: 'Face Savoring Food', shortcode: ':yum:' },
  { char: 'üòõ', name: 'Face with Tongue', shortcode: ':stuck_out_tongue:' },
  { char: 'üòú', name: 'Winking Face with Tongue', shortcode: ':stuck_out_tongue_winking_eye:' },
  { char: 'ü§™', name: 'Zany Face', shortcode: ':zany_face:' },
  { char: 'üòù', name: 'Squinting Face with Tongue', shortcode: ':stuck_out_tongue_closed_eyes:' },
  { char: 'ü§ë', name: 'Money-Mouth Face', shortcode: ':money_mouth_face:' },
  { char: 'ü§ó', name: 'Smiling Face with Open Hands', shortcode: ':hugs:' },
  { char: 'ü§≠', name: 'Face with Hand Over Mouth', shortcode: ':hand_over_mouth:' },
  { char: 'ü´¢', name: 'Face with Open Eyes and Hand Over Mouth', shortcode: ':face_with_open_eyes_and_hand_over_mouth:' },
  { char: 'ü´£', name: 'Face with Peeking Eye', shortcode: ':face_with_peeking_eye:' },
  { char: 'ü§´', name: 'Shushing Face', shortcode: ':shushing_face:' },
  { char: 'ü§î', name: 'Thinking Face', shortcode: ':thinking:' },
  { char: 'ü´°', name: 'Saluting Face', shortcode: ':saluting_face:' },
  { char: 'ü§ê', name: 'Zipper-Mouth Face', shortcode: ':zipper_mouth_face:' },
  { char: 'ü§®', name: 'Face with Raised Eyebrow', shortcode: ':raised_eyebrow:' },
  { char: 'üòê', name: 'Neutral Face', shortcode: ':neutral_face:' },
  { char: 'üòë', name: 'Expressionless Face', shortcode: ':expressionless:' },
  { char: 'üò∂', name: 'Face Without Mouth', shortcode: ':no_mouth:' },
  { char: 'ü´•', name: 'Dotted Line Face', shortcode: ':dotted_line_face:' },
  { char: 'üò∂‚Äçüå´Ô∏è', name: 'Face in Clouds', shortcode: ':face_in_clouds:' },
  { char: 'üòè', name: 'Smirking Face', shortcode: ':smirk:' },
  { char: 'üòí', name: 'Unamused Face', shortcode: ':unamused:' },
  { char: 'üôÑ', name: 'Face with Rolling Eyes', shortcode: ':roll_eyes:' },
  { char: 'üò¨', name: 'Grimacing Face', shortcode: ':grimacing:' },
  { char: 'üòÆ‚Äçüí®', name: 'Face Exhaling', shortcode: ':face_exhaling:' },
  { char: 'ü§•', name: 'Lying Face', shortcode: ':lying_face:' },
  { char: 'üòå', name: 'Relieved Face', shortcode: ':relieved:' },
  { char: 'üòî', name: 'Pensive Face', shortcode: ':pensive:' },
  { char: 'üò™', name: 'Sleepy Face', shortcode: ':sleepy:' },
  { char: 'ü§§', name: 'Drooling Face', shortcode: ':drooling_face:' },
  { char: 'üò¥', name: 'Sleeping Face', shortcode: ':sleeping:' },
])

const animalEmojis = ref<Emoji[]>([
  { char: 'üê∂', name: 'Dog Face', shortcode: ':dog:' },
  { char: 'üê±', name: 'Cat Face', shortcode: ':cat:' },
  { char: 'üê≠', name: 'Mouse Face', shortcode: ':mouse:' },
  { char: 'üêπ', name: 'Hamster', shortcode: ':hamster:' },
  { char: 'üê∞', name: 'Rabbit Face', shortcode: ':rabbit:' },
  { char: 'ü¶ä', name: 'Fox', shortcode: ':fox_face:' },
  { char: 'üêª', name: 'Bear', shortcode: ':bear:' },
  { char: 'üêº', name: 'Panda', shortcode: ':panda_face:' },
  { char: 'üê®', name: 'Koala', shortcode: ':koala:' },
  { char: 'üêØ', name: 'Tiger Face', shortcode: ':tiger:' },
  { char: 'ü¶Å', name: 'Lion', shortcode: ':lion:' },
  { char: 'üêÆ', name: 'Cow Face', shortcode: ':cow:' },
  { char: 'üê∑', name: 'Pig Face', shortcode: ':pig:' },
  { char: 'üêΩ', name: 'Pig Nose', shortcode: ':pig_nose:' },
  { char: 'üê∏', name: 'Frog', shortcode: ':frog:' },
  { char: 'üêµ', name: 'Monkey Face', shortcode: ':monkey_face:' },
  { char: 'üôà', name: 'See-No-Evil Monkey', shortcode: ':see_no_evil:' },
  { char: 'üôâ', name: 'Hear-No-Evil Monkey', shortcode: ':hear_no_evil:' },
  { char: 'üôä', name: 'Speak-No-Evil Monkey', shortcode: ':speak_no_evil:' },
  { char: 'üêí', name: 'Monkey', shortcode: ':monkey:' },
  { char: 'üêî', name: 'Chicken', shortcode: ':chicken:' },
  { char: 'üêß', name: 'Penguin', shortcode: ':penguin:' },
  { char: 'üê¶', name: 'Bird', shortcode: ':bird:' },
  { char: 'üê§', name: 'Baby Chick', shortcode: ':baby_chick:' },
  { char: 'üê£', name: 'Hatching Chick', shortcode: ':hatching_chick:' },
  { char: 'üê•', name: 'Front-Facing Baby Chick', shortcode: ':hatched_chick:' },
  { char: 'ü¶Ü', name: 'Duck', shortcode: ':duck:' },
  { char: 'ü¶Ö', name: 'Eagle', shortcode: ':eagle:' },
  { char: 'ü¶â', name: 'Owl', shortcode: ':owl:' },
  { char: 'ü¶á', name: 'Bat', shortcode: ':bat:' },
  { char: 'üê∫', name: 'Wolf', shortcode: ':wolf:' },
  { char: 'üêó', name: 'Boar', shortcode: ':boar:' },
  { char: 'üê¥', name: 'Horse Face', shortcode: ':horse:' },
  { char: 'ü¶Ñ', name: 'Unicorn', shortcode: ':unicorn:' },
  { char: 'üêù', name: 'Honeybee', shortcode: ':bee:' },
  { char: 'ü™≤', name: 'Beetle', shortcode: ':beetle:' },
  { char: 'ü¶ã', name: 'Butterfly', shortcode: ':butterfly:' },
  { char: 'üêå', name: 'Snail', shortcode: ':snail:' },
  { char: 'üêû', name: 'Lady Beetle', shortcode: ':ladybug:' },
  { char: 'üêú', name: 'Ant', shortcode: ':ant:' },
  { char: 'ü™∞', name: 'Fly', shortcode: ':fly:' },
  { char: 'ü™±', name: 'Worm', shortcode: ':worm:' },
  { char: 'ü¶ó', name: 'Cricket', shortcode: ':cricket:' },
  { char: 'üï∑Ô∏è', name: 'Spider', shortcode: ':spider:' },
  { char: 'üï∏Ô∏è', name: 'Spider Web', shortcode: ':spider_web:' },
  { char: 'ü¶Ç', name: 'Scorpion', shortcode: ':scorpion:' },
  { char: 'üê¢', name: 'Turtle', shortcode: ':turtle:' },
  { char: 'üêç', name: 'Snake', shortcode: ':snake:' },
  { char: 'ü¶é', name: 'Lizard', shortcode: ':lizard:' },
  { char: 'ü¶ñ', name: 'T-Rex', shortcode: ':t-rex:' },
  { char: 'ü¶ï', name: 'Sauropod', shortcode: ':sauropod:' },
])

const foodEmojis = ref<Emoji[]>([
  { char: 'üçé', name: 'Red Apple', shortcode: ':apple:' },
  { char: 'üçè', name: 'Green Apple', shortcode: ':green_apple:' },
  { char: 'üçä', name: 'Tangerine', shortcode: ':tangerine:' },
  { char: 'üçã', name: 'Lemon', shortcode: ':lemon:' },
  { char: 'üçå', name: 'Banana', shortcode: ':banana:' },
  { char: 'üçâ', name: 'Watermelon', shortcode: ':watermelon:' },
  { char: 'üçá', name: 'Grapes', shortcode: ':grapes:' },
  { char: 'üçì', name: 'Strawberry', shortcode: ':strawberry:' },
  { char: 'ü´ê', name: 'Blueberries', shortcode: ':blueberries:' },
  { char: 'üçà', name: 'Melon', shortcode: ':melon:' },
  { char: 'üçí', name: 'Cherries', shortcode: ':cherries:' },
  { char: 'üçë', name: 'Peach', shortcode: ':peach:' },
  { char: 'ü•≠', name: 'Mango', shortcode: ':mango:' },
  { char: 'üçç', name: 'Pineapple', shortcode: ':pineapple:' },
  { char: 'ü••', name: 'Coconut', shortcode: ':coconut:' },
  { char: 'ü•ù', name: 'Kiwi Fruit', shortcode: ':kiwi_fruit:' },
  { char: 'üçÖ', name: 'Tomato', shortcode: ':tomato:' },
  { char: 'üçÜ', name: 'Eggplant', shortcode: ':eggplant:' },
  { char: 'ü•ë', name: 'Avocado', shortcode: ':avocado:' },
  { char: 'ü•¶', name: 'Broccoli', shortcode: ':broccoli:' },
  { char: 'ü•¨', name: 'Leafy Greens', shortcode: ':leafy_greens:' },
  { char: 'ü•í', name: 'Cucumber', shortcode: ':cucumber:' },
  { char: 'üå∂Ô∏è', name: 'Hot Pepper', shortcode: ':hot_pepper:' },
  { char: 'ü´ë', name: 'Bell Pepper', shortcode: ':bell_pepper:' },
  { char: 'üåΩ', name: 'Ear of Corn', shortcode: ':corn:' },
  { char: 'ü•ï', name: 'Carrot', shortcode: ':carrot:' },
  { char: 'ü´í', name: 'Olive', shortcode: ':olive:' },
  { char: 'üßÑ', name: 'Garlic', shortcode: ':garlic:' },
  { char: 'üßÖ', name: 'Onion', shortcode: ':onion:' },
  { char: 'ü•î', name: 'Potato', shortcode: ':potato:' },
  { char: 'üç†', name: 'Roasted Sweet Potato', shortcode: ':sweet_potato:' },
  { char: 'ü•ê', name: 'Croissant', shortcode: ':croissant:' },
  { char: 'ü•ñ', name: 'Baguette Bread', shortcode: ':baguette_bread:' },
  { char: 'üçû', name: 'Bread', shortcode: ':bread:' },
  { char: 'ü•®', name: 'Pretzel', shortcode: ':pretzel:' },
  { char: 'ü•Ø', name: 'Bagel', shortcode: ':bagel:' },
  { char: 'ü•û', name: 'Pancakes', shortcode: ':pancakes:' },
  { char: 'üßá', name: 'Waffle', shortcode: ':waffle:' },
  { char: 'üßÄ', name: 'Cheese Wedge', shortcode: ':cheese:' },
  { char: 'üçñ', name: 'Meat on Bone', shortcode: ':meat_on_bone:' },
  { char: 'üçó', name: 'Poultry Leg', shortcode: ':poultry_leg:' },
  { char: 'ü•©', name: 'Cut of Meat', shortcode: ':cut_of_meat:' },
  { char: 'ü•ì', name: 'Bacon', shortcode: ':bacon:' },
  { char: 'üçî', name: 'Hamburger', shortcode: ':hamburger:' },
  { char: 'üçü', name: 'French Fries', shortcode: ':fries:' },
  { char: 'üçï', name: 'Pizza', shortcode: ':pizza:' },
  { char: 'üå≠', name: 'Hot Dog', shortcode: ':hotdog:' },
  { char: 'ü•™', name: 'Sandwich', shortcode: ':sandwich:' },
  { char: 'üåÆ', name: 'Taco', shortcode: ':taco:' },
  { char: 'üåØ', name: 'Burrito', shortcode: ':burrito:' },
])

const activityEmojis = ref<Emoji[]>([
  { char: '‚öΩ', name: 'Soccer Ball', shortcode: ':soccer:' },
  { char: 'üèÄ', name: 'Basketball', shortcode: ':basketball:' },
  { char: 'üèà', name: 'American Football', shortcode: ':football:' },
  { char: '‚öæ', name: 'Baseball', shortcode: ':baseball:' },
  { char: 'ü•é', name: 'Softball', shortcode: ':softball:' },
  { char: 'üéæ', name: 'Tennis', shortcode: ':tennis:' },
  { char: 'üèê', name: 'Volleyball', shortcode: ':volleyball:' },
  { char: 'üèâ', name: 'Rugby Football', shortcode: ':rugby_football:' },
  { char: 'ü•è', name: 'Flying Disc', shortcode: ':flying_disc:' },
  { char: 'üé±', name: 'Pool 8 Ball', shortcode: ':8ball:' },
  { char: 'ü™Ä', name: 'Yo-Yo', shortcode: ':yo_yo:' },
  { char: 'üèì', name: 'Ping Pong', shortcode: ':ping_pong:' },
  { char: 'üè∏', name: 'Badminton', shortcode: ':badminton:' },
  { char: 'ü•Ö', name: 'Goal Net', shortcode: ':goal_net:' },
  { char: '‚õ≥', name: 'Flag in Hole', shortcode: ':golf:' },
  { char: 'ü™Å', name: 'Kite', shortcode: ':kite:' },
  { char: 'üèπ', name: 'Bow and Arrow', shortcode: ':bow_and_arrow:' },
  { char: 'üé£', name: 'Fishing Pole', shortcode: ':fishing_pole_and_fish:' },
  { char: 'ü§ø', name: 'Diving Mask', shortcode: ':diving_mask:' },
  { char: 'ü•ä', name: 'Boxing Glove', shortcode: ':boxing_glove:' },
  { char: 'ü•ã', name: 'Martial Arts Uniform', shortcode: ':martial_arts_uniform:' },
  { char: 'üéΩ', name: 'Running Shirt', shortcode: ':running_shirt_with_sash:' },
  { char: 'üõπ', name: 'Skateboard', shortcode: ':skateboard:' },
  { char: 'üõ∑', name: 'Sled', shortcode: ':sled:' },
  { char: '‚õ∏Ô∏è', name: 'Ice Skate', shortcode: ':ice_skate:' },
  { char: 'ü•å', name: 'Curling Stone', shortcode: ':curling_stone:' },
  { char: 'üéø', name: 'Skis', shortcode: ':ski:' },
  { char: '‚õ∑Ô∏è', name: 'Skier', shortcode: ':skier:' },
  { char: 'üèÇ', name: 'Snowboarder', shortcode: ':snowboarder:' },
  { char: 'ü™Ç', name: 'Parachute', shortcode: ':parachute:' },
  { char: 'üèãÔ∏è‚Äç‚ôÄÔ∏è', name: 'Woman Lifting Weights', shortcode: ':weight_lifting_woman:' },
  { char: 'üèãÔ∏è‚Äç‚ôÇÔ∏è', name: 'Man Lifting Weights', shortcode: ':weight_lifting_man:' },
  { char: 'ü§º‚Äç‚ôÄÔ∏è', name: 'Women Wrestling', shortcode: ':women_wrestling:' },
  { char: 'ü§º‚Äç‚ôÇÔ∏è', name: 'Men Wrestling', shortcode: ':men_wrestling:' },
  { char: 'ü§∏‚Äç‚ôÄÔ∏è', name: 'Woman Cartwheeling', shortcode: ':woman_cartwheeling:' },
  { char: 'ü§∏‚Äç‚ôÇÔ∏è', name: 'Man Cartwheeling', shortcode: ':man_cartwheeling:' },
  { char: '‚õπÔ∏è‚Äç‚ôÄÔ∏è', name: 'Woman Bouncing Ball', shortcode: ':woman_bouncing_ball:' },
  { char: '‚õπÔ∏è‚Äç‚ôÇÔ∏è', name: 'Man Bouncing Ball', shortcode: ':man_bouncing_ball:' },
  { char: 'ü§∫', name: 'Person Fencing', shortcode: ':person_fencing:' },
  { char: 'ü§æ‚Äç‚ôÄÔ∏è', name: 'Woman Playing Handball', shortcode: ':woman_playing_handball:' },
  { char: 'ü§æ‚Äç‚ôÇÔ∏è', name: 'Man Playing Handball', shortcode: ':man_playing_handball:' },
  { char: 'üèåÔ∏è‚Äç‚ôÄÔ∏è', name: 'Woman Golfing', shortcode: ':woman_golfing:' },
  { char: 'üèåÔ∏è‚Äç‚ôÇÔ∏è', name: 'Man Golfing', shortcode: ':man_golfing:' },
  { char: 'üèá', name: 'Horse Racing', shortcode: ':horse_racing:' },
  { char: 'üßò‚Äç‚ôÄÔ∏è', name: 'Woman in Lotus Position', shortcode: ':woman_in_lotus_position:' },
  { char: 'üßò‚Äç‚ôÇÔ∏è', name: 'Man in Lotus Position', shortcode: ':man_in_lotus_position:' },
  { char: 'üèÑ‚Äç‚ôÄÔ∏è', name: 'Woman Surfing', shortcode: ':woman_surfing:' },
  { char: 'üèÑ‚Äç‚ôÇÔ∏è', name: 'Man Surfing', shortcode: ':man_surfing:' },
  { char: 'üèä‚Äç‚ôÄÔ∏è', name: 'Woman Swimming', shortcode: ':woman_swimming:' },
  { char: 'üèä‚Äç‚ôÇÔ∏è', name: 'Man Swimming', shortcode: ':man_swimming:' },
])

const objectEmojis = ref<Emoji[]>([
  { char: 'üí°', name: 'Light Bulb', shortcode: ':bulb:' },
  { char: 'üî¶', name: 'Flashlight', shortcode: ':flashlight:' },
  { char: 'üïØÔ∏è', name: 'Candle', shortcode: ':candle:' },
  { char: 'ü™î', name: 'Diya Lamp', shortcode: ':diya_lamp:' },
  { char: 'üî•', name: 'Fire', shortcode: ':fire:' },
  { char: 'üßØ', name: 'Fire Extinguisher', shortcode: ':fire_extinguisher:' },
  { char: 'üõ¢Ô∏è', name: 'Oil Drum', shortcode: ':oil_drum:' },
  { char: 'üí∏', name: 'Money with Wings', shortcode: ':money_with_wings:' },
  { char: 'üíµ', name: 'Dollar Banknote', shortcode: ':dollar:' },
  { char: 'üí¥', name: 'Yen Banknote', shortcode: ':yen:' },
  { char: 'üí∂', name: 'Euro Banknote', shortcode: ':euro:' },
  { char: 'üí∑', name: 'Pound Banknote', shortcode: ':pound:' },
  { char: 'ü™ô', name: 'Coin', shortcode: ':coin:' },
  { char: 'üí∞', name: 'Money Bag', shortcode: ':moneybag:' },
  { char: 'üí≥', name: 'Credit Card', shortcode: ':credit_card:' },
  { char: 'üíé', name: 'Gem Stone', shortcode: ':gem:' },
  { char: '‚öñÔ∏è', name: 'Balance Scale', shortcode: ':balance_scale:' },
  { char: 'ü™ú', name: 'Ladder', shortcode: ':ladder:' },
  { char: 'üß∞', name: 'Toolbox', shortcode: ':toolbox:' },
  { char: 'üîß', name: 'Wrench', shortcode: ':wrench:' },
  { char: 'üî®', name: 'Hammer', shortcode: ':hammer:' },
  { char: '‚öíÔ∏è', name: 'Hammer and Pick', shortcode: ':hammer_and_pick:' },
  { char: 'üõ†Ô∏è', name: 'Hammer and Wrench', shortcode: ':hammer_and_wrench:' },
  { char: '‚õèÔ∏è', name: 'Pick', shortcode: ':pick:' },
  { char: 'ü™ö', name: 'Carpentry Saw', shortcode: ':carpentry_saw:' },
  { char: 'üî©', name: 'Nut and Bolt', shortcode: ':nut_and_bolt:' },
  { char: '‚öôÔ∏è', name: 'Gear', shortcode: ':gear:' },
  { char: 'ü™§', name: 'Mouse Trap', shortcode: ':mouse_trap:' },
  { char: 'üß≤', name: 'Magnet', shortcode: ':magnet:' },
  { char: 'ü™£', name: 'Bucket', shortcode: ':bucket:' },
  { char: 'üî´', name: 'Water Pistol', shortcode: ':gun:' },
  { char: 'üß®', name: 'Firecracker', shortcode: ':firecracker:' },
  { char: 'ü™ì', name: 'Axe', shortcode: ':axe:' },
  { char: 'üî™', name: 'Kitchen Knife', shortcode: ':hocho:' },
  { char: 'üó°Ô∏è', name: 'Dagger', shortcode: ':dagger:' },
  { char: '‚öîÔ∏è', name: 'Crossed Swords', shortcode: ':crossed_swords:' },
  { char: 'üõ°Ô∏è', name: 'Shield', shortcode: ':shield:' },
  { char: 'üö¨', name: 'Cigarette', shortcode: ':smoking:' },
  { char: '‚ö∞Ô∏è', name: 'Coffin', shortcode: ':coffin:' },
  { char: 'ü™¶', name: 'Headstone', shortcode: ':headstone:' },
  { char: '‚ö±Ô∏è', name: 'Funeral Urn', shortcode: ':funeral_urn:' },
  { char: 'üè∫', name: 'Amphora', shortcode: ':amphora:' },
  { char: 'üîÆ', name: 'Crystal Ball', shortcode: ':crystal_ball:' },
  { char: 'üìø', name: 'Prayer Beads', shortcode: ':prayer_beads:' },
  { char: 'üßø', name: 'Nazar Amulet', shortcode: ':nazar_amulet:' },
  { char: 'üíà', name: 'Barber Pole', shortcode: ':barber:' },
  { char: '‚öóÔ∏è', name: 'Alembic', shortcode: ':alembic:' },
  { char: 'üî≠', name: 'Telescope', shortcode: ':telescope:' },
  { char: 'üî¨', name: 'Microscope', shortcode: ':microscope:' },
])

// Load recent emojis from localStorage
onMounted(() => {
  const saved = localStorage.getItem('recent-emojis')
  if (saved) {
    try {
      recentEmojis.value = JSON.parse(saved)
    } catch {
      // Ignore parsing errors
    }
  }
  
  // Filter emojis based on OS support
  smileyEmojis.value = filterSupportedEmojis(smileyEmojis.value)
  animalEmojis.value = filterSupportedEmojis(animalEmojis.value)
  foodEmojis.value = filterSupportedEmojis(foodEmojis.value)
  activityEmojis.value = filterSupportedEmojis(activityEmojis.value)
  objectEmojis.value = filterSupportedEmojis(objectEmojis.value)
})

function selectEmoji(emoji: Emoji) {
  // Add to recent emojis
  const filtered = recentEmojis.value.filter(e => e.char !== emoji.char)
  recentEmojis.value = [emoji, ...filtered].slice(0, 24) // Keep only 24 recent emojis
  
  // Save to localStorage
  localStorage.setItem('recent-emojis', JSON.stringify(recentEmojis.value))
  
  // Emit the emoji
  emit('insert-emoji', emoji)
  emit('update:open', false)
}
</script>
